# æ€§èƒ½ç›‘æ§å¿«é€Ÿå…¥é—¨

## ğŸš€ 5åˆ†é’Ÿä¸Šæ‰‹æ€§èƒ½ç›‘æ§

### ç¬¬ä¸€æ­¥ï¼šå¯åŠ¨æœåŠ¡

```bash
# å…‹éš†é¡¹ç›®
cd star

# å®‰è£…ä¾èµ–
npm install

# å¯åŠ¨æœåŠ¡ï¼ˆæ€§èƒ½ç›‘æ§é»˜è®¤å¯ç”¨ï¼‰
npm start
```

### ç¬¬äºŒæ­¥ï¼šæŸ¥çœ‹ç›‘æ§è¾“å‡º

æœåŠ¡å¯åŠ¨åï¼Œæ¯ 10 ç§’ä¼šè‡ªåŠ¨è¾“å‡ºæ€§èƒ½æŠ¥å‘Šï¼š

```
================================================================================
ğŸ“Š æ€§èƒ½ç›‘æ§æŠ¥å‘Š
================================================================================

ğŸš€ QPS (æ¯ç§’æŸ¥è¯¢æ•°):
   å½“å‰å‘¨æœŸ: 45.23 req/s
   å¹³å‡: 42.15 req/s

ğŸ“ˆ è¯·æ±‚ç»Ÿè®¡:
   æ€»è¯·æ±‚æ•°: 12543
   æˆåŠŸ: 12538 | å¤±è´¥: 5
   æˆåŠŸç‡: 99.96%

â±ï¸  å“åº”æ—¶é—´ (ms):
   å¹³å‡: 125.34ms
   æœ€å°: 23.45ms | æœ€å¤§: 890.12ms
   P50: 98.23ms | P95: 234.56ms | P99: 456.78ms

ğŸ’¾ å†…å­˜ä½¿ç”¨:
   å †å†…å­˜: 156.23MB / 256.00MB
   RSS: 234.56MB

â° è¿è¡Œæ—¶é—´: 5åˆ†é’Ÿ 23ç§’
================================================================================
```

### ç¬¬ä¸‰æ­¥ï¼šè¿è¡Œæ€§èƒ½æµ‹è¯•

```bash
# è¿è¡Œå•ä¸ªæµ‹è¯•
npm run benchmark

# è¿è¡Œå®Œæ•´æµ‹è¯•å¥—ä»¶
npm run benchmark:suite
```

æµ‹è¯•ç»“æœç¤ºä¾‹ï¼š

```
ğŸš€ æ€§èƒ½æµ‹è¯•å¼€å§‹...

============================================================
å·¥å…·: get_zodiac_info
å‚æ•°: {"zodiac":"ç™½ç¾Šåº§"}
æŒç»­æ—¶é—´: 30ç§’
å¹¶å‘æ•°: 10
============================================================

ğŸ“Š å·²å®Œæˆ: 1250 è¯·æ±‚ | QPS: 41.67 | æˆåŠŸç‡: 100.0%

============================================================
ğŸ“Š æ€§èƒ½æµ‹è¯•ç»“æœ
============================================================

ğŸš€ ååé‡:
   æ€»è¯·æ±‚æ•°: 1250
   æˆåŠŸ: 1250 | å¤±è´¥: 0
   æˆåŠŸç‡: 100.00%
   QPS: 41.67 è¯·æ±‚/ç§’

â±ï¸  å“åº”æ—¶é—´:
   å¹³å‡: 239.45ms
   æœ€å°: 89.23ms
   æœ€å¤§: 567.89ms
   P50: 218.34ms
   P95: 389.56ms
   P99: 478.90ms

ğŸ“ˆ æ€§èƒ½è¯„ä¼°:
   âœ… QPS ä¸€èˆ¬ (20-50)
   âœ… å“åº”æ—¶é—´è‰¯å¥½ (100-500ms)
   âœ… å¯é æ€§ä¼˜ç§€ (>99%)
```

## ğŸ“Š ç†è§£æ€§èƒ½æŒ‡æ ‡

### QPS (æ¯ç§’æŸ¥è¯¢æ•°)

è¡¨ç¤ºæœåŠ¡æ¯ç§’èƒ½å¤„ç†å¤šå°‘è¯·æ±‚ï¼š
- **> 100**: ä¼˜ç§€ âœ…
- **50-100**: è‰¯å¥½ âœ…
- **20-50**: ä¸€èˆ¬ âš ï¸
- **< 20**: éœ€è¦ä¼˜åŒ– âŒ

### å“åº”æ—¶é—´

è¯·æ±‚ä»å‘èµ·åˆ°è¿”å›çš„è€—æ—¶ï¼š
- **< 100ms**: ä¼˜ç§€ âœ…
- **100-500ms**: è‰¯å¥½ âœ…
- **500-1000ms**: ä¸€èˆ¬ âš ï¸
- **> 1000ms**: éœ€è¦ä¼˜åŒ– âŒ

### ç™¾åˆ†ä½æ•° (P50/P95/P99)

- **P50**: 50% çš„è¯·æ±‚å“åº”æ—¶é—´ä½äºæ­¤å€¼
- **P95**: 95% çš„è¯·æ±‚å“åº”æ—¶é—´ä½äºæ­¤å€¼
- **P99**: 99% çš„è¯·æ±‚å“åº”æ—¶é—´ä½äºæ­¤å€¼

P95 å’Œ P99 èƒ½åæ˜ ç³»ç»Ÿçš„ç¨³å®šæ€§ï¼Œå€¼è¶Šä½è¶Šå¥½ã€‚

## âš™ï¸ æ€§èƒ½ä¼˜åŒ–

### åœºæ™¯ 1: QPS å¤ªä½

**é—®é¢˜**: QPS åªæœ‰ 20

**è§£å†³æ–¹æ¡ˆ**:

```bash
# å¢åŠ å¹¶å‘æ•°
MAX_CONCURRENT=20 npm start

# æˆ–ä½¿ç”¨ Docker éƒ¨ç½²å¤šå®ä¾‹
docker-compose up --scale star-mcp=4
```

### åœºæ™¯ 2: å“åº”æ—¶é—´æ…¢

**é—®é¢˜**: å¹³å‡å“åº”æ—¶é—´ > 500ms

**è§£å†³æ–¹æ¡ˆ**:

1. æŸ¥çœ‹å“ªä¸ªå·¥å…·æœ€æ…¢ï¼š
```
ğŸ”§ æŒ‰å·¥å…·ç»Ÿè®¡:
   get_rising_sign:
     å¹³å‡è€—æ—¶: 890.45ms  â† è¿™ä¸ªå·¥å…·å¾ˆæ…¢
```

2. é’ˆå¯¹æ€§ä¼˜åŒ–æˆ–å¯ç”¨ç¼“å­˜

### åœºæ™¯ 3: å†…å­˜ä½¿ç”¨é«˜

**é—®é¢˜**: å†…å­˜ä½¿ç”¨è¶…è¿‡é™åˆ¶

**è§£å†³æ–¹æ¡ˆ**:

```bash
# å¢åŠ å†…å­˜é™åˆ¶
MAX_MEMORY_MB=1024 npm start

# æˆ–å‡å°‘å¹¶å‘æ•°
MAX_CONCURRENT=10 npm start
```

## ğŸ³ Docker ç¯å¢ƒç›‘æ§

### å¯åŠ¨ Docker æœåŠ¡

```bash
# æ„å»ºé•œåƒ
npm run docker:build

# å¯åŠ¨æœåŠ¡
npm run docker:run

# æŸ¥çœ‹æ—¥å¿—ï¼ˆåŒ…å«æ€§èƒ½æŠ¥å‘Šï¼‰
npm run docker:logs

# æŸ¥çœ‹èµ„æºä½¿ç”¨
npm run docker:stats
```

### Docker æ€§èƒ½é…ç½®

ç¼–è¾‘ `docker-compose.yml`:

```yaml
services:
  star-mcp:
    environment:
      - PERFORMANCE_MONITOR=true
      - MAX_CONCURRENT=20
      - MAX_MEMORY_MB=512
    deploy:
      resources:
        limits:
          cpus: '1.0'
          memory: 512M
```

## ğŸ“ˆ ç”Ÿäº§ç¯å¢ƒé…ç½®

### æ¨èé…ç½®

```bash
# env.example â†’ .env
NODE_ENV=production
PERFORMANCE_MONITOR=true
MAX_MEMORY_MB=512
MAX_CONCURRENT=20
MAX_RPS=100
LOG_LEVEL=info
```

### å¯åŠ¨ç”Ÿäº§æœåŠ¡

```bash
npm run start:prod
```

## ğŸ” å¸¸è§é—®é¢˜

### Q1: æ€§èƒ½æŠ¥å‘Šå¤ªé¢‘ç¹ï¼Ÿ

è°ƒæ•´è¾“å‡ºé—´éš”ï¼š

```bash
# æ”¹ä¸º30ç§’è¾“å‡ºä¸€æ¬¡
PERF_LOG_INTERVAL=30000 npm start
```

### Q2: ç¦ç”¨æ€§èƒ½ç›‘æ§ï¼Ÿ

```bash
# å®Œå…¨ç¦ç”¨
PERFORMANCE_MONITOR=false npm start
```

### Q3: å¦‚ä½•å¯¼å‡ºæ€§èƒ½æ•°æ®ï¼Ÿ

åœ¨ä»£ç ä¸­ä½¿ç”¨ï¼š

```javascript
import { getMonitor } from './performance-monitor.js';

const monitor = getMonitor();
const stats = monitor.exportStats();
console.log(JSON.stringify(stats, null, 2));
```

## ğŸ“š è¿›é˜¶é˜…è¯»

- [å®Œæ•´æ€§èƒ½ç›‘æ§æ–‡æ¡£](./PERFORMANCE.md)
- [Docker éƒ¨ç½²æŒ‡å—](./README.md#docker-éƒ¨ç½²)
- [æ€§èƒ½ä¼˜åŒ–æ¡ˆä¾‹](./PERFORMANCE.md#æ€§èƒ½ä¼˜åŒ–æ¡ˆä¾‹)

## ğŸ¯ æ€§èƒ½ç›®æ ‡

### åŸºå‡†ç›®æ ‡ï¼ˆå•å®ä¾‹ï¼‰

- QPS: 50+ 
- å¹³å‡å“åº”æ—¶é—´: < 200ms
- P95 å“åº”æ—¶é—´: < 500ms
- æˆåŠŸç‡: > 99%
- å†…å­˜ä½¿ç”¨: < 400MB

### ä¼˜åŒ–ç›®æ ‡ï¼ˆå¤šå®ä¾‹ï¼‰

- QPS: 100+
- å¹³å‡å“åº”æ—¶é—´: < 100ms
- P95 å“åº”æ—¶é—´: < 300ms
- æˆåŠŸç‡: > 99.9%
- å•å®ä¾‹å†…å­˜: < 256MB

## ğŸ’¡ æœ€ä½³å®è·µ

1. **æŒç»­ç›‘æ§**: ä¿æŒæ€§èƒ½ç›‘æ§å¼€å¯
2. **å®šæœŸæµ‹è¯•**: æ¯æ¬¡æ›´æ–°åè¿è¡Œæ€§èƒ½æµ‹è¯•
3. **èµ„æºè§„åˆ’**: æ ¹æ®ç›‘æ§æ•°æ®è°ƒæ•´èµ„æºé…ç½®
4. **å‘Šè­¦è®¾ç½®**: å†…å­˜/QPS å¼‚å¸¸æ—¶åŠæ—¶å‘Šè­¦
5. **æ—¥å¿—åˆ†æ**: å®šæœŸåˆ†ææ€§èƒ½æŠ¥å‘Š

---

**å‡†å¤‡å¥½äº†å—ï¼Ÿç°åœ¨å°±å¼€å§‹ç›‘æ§ä½ çš„æœåŠ¡æ€§èƒ½ï¼** ğŸš€

